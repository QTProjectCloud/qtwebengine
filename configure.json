{
    "files": {
       "privatePro": "src/qtwebengine-main-config.pri"
    },

    "subconfigs": [
        "src/core",
        "src/webengine",
        "src/webenginewidgets"
    ],
    "commandline": {
        "options": {
            "webengine-core": "boolean"
        }
    },
    "libraries": {
        "webengine-dbus": {
            "label": "d-bus",
            "sources": [
                { "type": "pkgConfig", "args": "dbus-1" }
            ]
        },
        "webengine-fontconfig": {
            "label": "fontconfig",
            "sources": [
                { "type": "pkgConfig", "args": "fontconfig" }
            ]
        },
        "webengine-libdrm": {
            "label": "libdrm",
            "sources": [
                { "type": "pkgConfig", "args": "libdrm" }
            ]
        },
        "webengine-xcomposite": {
            "label": "xcomposite",
            "sources": [
                { "type": "pkgConfig", "args": "xcomposite" }
            ]
        },
        "webengine-xcursor": {
            "label": "xcursor",
            "sources": [
                { "type": "pkgConfig", "args": "xcursor" }
            ]
        },
        "webengine-xi": {
            "label": "xi",
            "sources": [
                { "type": "pkgConfig", "args": "xi" }
            ]
        },
        "webengine-xtst": {
            "label": "xtst",
            "sources": [
                { "type": "pkgConfig", "args": "xtst" }
            ]
        },
        "webengine-nss": {
            "label": "nss >= 3.26",
            "sources": [
                { "type": "pkgConfig", "args": "nss >= 3.26" }
            ]
        },
        "webengine-x11" : {
            "label" : "x11",
            "sources": [
                { "type": "pkgConfig", "args": "x11" }
            ]
        }
    },

    "testDir": "config.tests",
    "tests" : {
        "webengine-bison": {
            "label": "bison",
            "type": "detectBison"
        },
        "webengine-flex": {
            "label": "flex",
            "type": "detectFlex"
        },
        "webengine-gn": {
            "label": "system gn",
            "type": "detectGn"
        },
        "webengine-glibc": {
            "label": "glibc > 2.26",
            "type": "compile",
            "test": {
                "include": "features.h",
                "tail": [
                    "#if __GLIBC__ < 2 || __GLIBC_MINOR__ < 27",
                    "#error glibc versions below 2.27 are not supported",
                    "#endif"
                ]
            }
        },
        "webengine-gperf": {
            "label": "gperf",
            "type": "detectGperf"
        },
        "webengine-khr": {
            "label": "khr",
            "type": "compile",
            "test": {
                "include": "KHR/khrplatform.h",
                "qmake" : [
                    "!isEmpty(QMAKE_INCDIR_EGL): INCLUDEPATH += $$QMAKE_INCDIR_EGL",
                    "!isEmpty(QMAKE_INCDIR_OPENGL): INCLUDEPATH += $$QMAKE_INCDIR_OPENGL"
                ]
            }
        },
        "webengine-ninja": {
            "label": "system ninja",
            "type": "detectNinja"
        },
        "webengine-python2": {
            "label": "python2",
            "type": "detectPython2",
            "log": "location"
        },
        "webengine-winversion": {
            "label": "winversion",
            "type": "compile",
            "test": {
                 "head" : [
                    "#if !defined(__clang__) && _MSC_FULL_VER < 191426428",
                    "#error unsupported Visual Studio version",
                    "#endif"
                 ]
            }
        },
        "webengine-host-pkg-config": {
                   "label": "host pkg-config",
                   "type": "detectHostPkgConfig",
                   "log": "path"
        },
        "webengine-xcb": {
            "label": "qtbase xcb",
            "type": "detectXcb"
        }
    },
    "features": {
        "webengine-core": {
            "label": "Support Qt WebEngine Core",
            "purpose": "Provides WebEngine Core support.",
            "condition": "module.gui
                         && features.webengine-python2
                         && features.webengine-gperf
                         && features.webengine-bison
                         && features.webengine-flex
                         && (!tests.webengine-xcb || features.webengine-ozone-x11)",
            "output": [ "privateFeature" ]
        },
        "webengine-python2": {
            "label": "python2",
            "condition": "tests.webengine-python2",
            "output": [
                "privateFeature",
                { "type": "varAssign", "name": "QMAKE_PYTHON2", "value": "tests.webengine-python2.location" }
            ]
        },
        "webengine-gperf": {
            "label": "gperf",
            "condition": "tests.webengine-gperf",
            "output": [ "privateFeature" ]
        },
        "webengine-bison": {
            "label": "bison",
            "condition": "tests.webengine-bison",
            "output": [ "privateFeature" ]
        },
        "webengine-flex": {
            "label": "flex",
            "condition": "tests.webengine-flex",
            "output": [ "privateFeature" ]
        },
        "webengine-system-ninja": {
            "label": "Use System Ninja",
            "condition": "tests.webengine-ninja",
            "output": [ "privateFeature" ]
        },
           "webengine-system-fontconfig": {
            "label": "fontconfig",
            "condition": "libs.webengine-fontconfig",
            "output": [ "privateFeature" ]
        },
        "webengine-system-dbus": {
            "label": "dbus",
            "condition": "libs.webengine-dbus",
            "output": [ "privateFeature" ]
        },
        "webengine-system-libdrm": {
            "label": "libdrm",
            "condition": "libs.webengine-libdrm",
            "output": [ "privateFeature" ]
        },
        "webengine-system-xcomposite": {
            "label": "xcomposite",
            "condition": "libs.webengine-xcomposite",
            "output": [ "privateFeature" ]
        },
        "webengine-system-xcursor": {
            "label": "xcursor",
            "condition": "libs.webengine-xcursor",
            "output": [ "privateFeature" ]
        },
        "webengine-system-xi": {
            "label": "xi",
            "condition": "libs.webengine-xi",
            "output": [ "privateFeature" ]
        },
        "webengine-system-xtst": {
            "label": "xtst",
            "condition": "libs.webengine-xtst",
            "output": [ "privateFeature" ]
        },
        "webengine-system-gn": {
            "label": "Use System Gn",
            "autoDetect": "false",
            "condition": "tests.webengine-gn",
            "output": [ "privateFeature" ]
        },
        "webengine-system-khr" : {
            "label": "khr",
            "condition": "config.unix && tests.webengine-khr",
            "output": [ "privateFeature" ]
        },
        "webengine-system-nss": {
            "label": "nss",
            "condition": "config.unix && !config.darwin && libs.webengine-nss",
            "output": [ "privateFeature" ]
        },
        "webengine-system-glibc": {
            "label": "glibc",
            "condition": "config.linux && tests.webengine-glibc",
            "output": [ "privateFeature" ]
        },
        "webengine-system-x11" : {
            "label": "x11",
            "condition": "config.unix && libs.webengine-x11",
            "output": [ "privateFeature" ]
        },
        "webengine-host-pkg-config": {
            "label": "host-pkg-config",
            "condition": "config.unix && tests.webengine-host-pkg-config",
            "output": [
                "privateFeature",
                { "type": "varAssign", "name": "QMAKE_PKG_CONFIG_HOST", "value": "tests.webengine-host-pkg-config.path" }
            ]
        },
        "webengine-ozone-x11" : {
             "label": "Support qpa-xcb",
             "condition": "config.unix
                          && tests.webengine-xcb
                          && features.webengine-system-x11
                          && features.webengine-system-libdrm
                          && features.webengine-system-xcomposite
                          && features.webengine-system-xcursor
                          && features.webengine-system-xi
                          && features.webengine-system-xtst",
             "output": [ "privateFeature" ]
        },
        "webengine-winversion" : {
            "label": "winversion",
            "condition": "config.win32 && tests.webengine-winversion",
            "output": [ "privateFeature" ]
        }
    },
    "report": [
        {
            "type": "warning",
            "condition": "!module.gui",
            "message": "QtWebEngine requires QtGui."
        },
        {
            "type": "warning",
            "condition": "!features.webengine-python2",
            "message": "Python version 2 (2.7.5 or later) is required to build QtWebEngine."
        },
        {
            "type": "warning",
            "condition": "!features.webengine-gperf",
            "message": "gperf is required to build QtWebEngine."
        },
        {
            "type": "warning",
            "condition": "!features.webengine-bison",
            "message": "bison is required to build QtWebEngine."
        },
        {
            "type": "warning",
            "condition": "!features.webengine-flex",
            "message": "flex is required to build QtWebEngine."
        },
        {
            "type": "warning",
            "condition": "config.linux && !features.webengine-ozone-x11 && tests.webengine-xcb",
            "message": "Could not find all necessary libraries for qpa-xcb support."
        }
    ],
    "summary": [
        {
            "section": "Build Tools",
            "entries": [
                "webengine-system-ninja",
                "webengine-system-gn"
            ]
        },
        {
            "section": "Required system libraries",
            "condition": "config.unix && !config.macos && features.webengine-core",
            "entries": [
                "webengine-system-fontconfig",
                "webengine-system-dbus",
                "webengine-system-nss",
                "webengine-system-khr",
                "webengine-system-glibc"
            ]
        },
        {
            "section": "Required system libraries for qpa-xcb",
            "condition": "config.unix && !config.macos && features.webengine-core",
            "entries": [
                "webengine-system-x11",
                "webengine-system-libdrm",
                "webengine-system-xcomposite",
                "webengine-system-xcursor",
                "webengine-system-xi",
                "webengine-system-xtst"
             ]
        }
    ]
}
